# Локальная настройка Community Node

Это руководство поможет вам связать локально разрабатываемую community node с запущенным n8n локально.

## Предварительные требования

- Установленный Node.js (версия 16 или выше)
- Установленный npm
- Локально запущенный n8n
- Git (для клонирования репозитория)

## Пошаговая настройка

### 1. Создание структуры кастомных модулей

```bash
# Создаем директорию для кастомных модулей n8n
mkdir -p ~/.n8n/custom/node_modules

# Переходим в директорию кастомных модулей
cd ~/.n8n/custom

# Инициализируем package.json для кастомных модулей
npm init -y
```

**Что делают эти команды:**
- `mkdir -p ~/.n8n/custom/node_modules` - создает директорию для кастомных модулей n8n в домашней папке пользователя
- `cd ~/.n8n/custom` - переходит в созданную директорию
- `npm init -y` - создает package.json с настройками по умолчанию

### 2. Создание символической ссылки

```bash
# Создаем символическую ссылку на ваш проект
ln -s /Users/v.tarasenko/Projects/n8n_telegram_stars_node node_modules/n8n-nodes-telegram-stars
```

**Что делает эта команда:**
- `ln -s` - создает символическую ссылку (symlink)
- Первый путь - путь к вашему проекту
- Второй путь - где будет доступен модуль для n8n

### 3. Установка зависимостей и сборка

```bash
# Переходим в директорию проекта
cd /Users/v.tarasenko/Projects/n8n_telegram_stars_node

# Устанавливаем зависимости
npm install

# Собираем проект
npm run build
```

**Что делают эти команды:**
- `npm install` - устанавливает все зависимости из package.json
- `npm run build` - компилирует TypeScript код в JavaScript

### 4. Создание npm link (альтернативный метод)

```bash
# В директории проекта создаем глобальную ссылку
npm link

# В директории кастомных модулей n8n подключаем ссылку
cd ~/.n8n/custom
npm link n8n-nodes-telegram-stars
```

**Что делают эти команды:**
- `npm link` - создает глобальную символическую ссылку на пакет
- `npm link n8n-nodes-telegram-stars` - подключает пакет в текущей директории

## Полезные команды

### Сборка проекта
```bash
npm run build
```

### Сборка в режиме наблюдения (для разработки)
```bash
npm run build:watch
```

### Очистка собранных файлов
```bash
npm run clean
```

### Запуск n8n в режиме разработки
```bash
n8n start
```

### Запуск n8n с отладкой
```bash
DEBUG=n8n* n8n start
```

### Проверка установленных community nodes
```bash
n8n list:community-nodes
```

## Проверка работы

1. Запустите n8n: `n8n start`
2. Откройте веб-интерфейс n8n (обычно http://localhost:5678)
3. Создайте новый workflow
4. В списке узлов найдите "Telegram Stars"
5. Если узел отображается, настройка прошла успешно

## Решение проблем

### Узел не отображается в n8n
- Убедитесь, что проект собран: `npm run build`
- Проверьте, что символическая ссылка создана правильно
- Перезапустите n8n

### Ошибки при сборке
- Убедитесь, что все зависимости установлены: `npm install`
- Проверьте версию Node.js: `node --version`
- Очистите кэш npm: `npm cache clean --force`

### Проблемы с правами доступа
- Убедитесь, что у вас есть права на создание символических ссылок
- На macOS может потребоваться разрешение на доступ к файловой системе

## Структура файлов

```
~/.n8n/custom/
├── node_modules/
│   └── n8n-nodes-telegram-stars/ -> /Users/v.tarasenko/Projects/n8n_telegram_stars_node
└── package.json
```

## Дополнительные настройки

### Настройка переменных окружения
Создайте файл `.env` в корне проекта:
```env
N8N_CUSTOM_EXTENSIONS=/Users/v.tarasenko/.n8n/custom
```

### Настройка TypeScript
Убедитесь, что в `tsconfig.json` правильно настроены пути:
```json
{
  "compilerOptions": {
    "outDir": "./dist",
    "rootDir": "./"
  }
}
```

## Поддержка

Если у вас возникли проблемы с настройкой, создайте issue в репозитории проекта или обратитесь к автору.
